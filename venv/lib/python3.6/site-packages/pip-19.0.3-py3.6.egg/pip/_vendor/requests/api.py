# -*- coding: utf-8 -*-

"""
requests.api
~~~~~~~~~~~~

This module implements the Requests API.

:copyright: (c) 2012 by Kenneth Reitz.
:license: Apache2, see LICENSE for more details.
"""

from . import sessions


def request(method, url, **kwargs):
    """Constructs and sends a :class:`Request <Request>`.

    Usage::

        >>> import requests
        >>> req = requests.request('GET', 'https://httpbin.org/get')
        <Response [200]>

    Args:
        method: method for the new :class:`Request` object.
        url: URL for the new :class:`Request` object.
        **kwargs:

    Returns:
        requests.Response: :class:`Response <Response>` object
    """

    # By using the 'with' statement we are sure the session is closed, thus we
    # avoid leaving sockets open which can trigger a ResourceWarning in some
    # cases, and look like a memory leak in others.
    with sessions.Session() as session:
        return session.request(method=method, url=url, **kwargs)


def get(url, params=None, **kwargs):
    """Sends a GET request.

    Args:
        url: URL for the new :class:`Request` object.
        params: (optional) Dictionary, list of tuples or bytes to send in the
            body of the :class:`Request`.
        **kwargs: Optional arguments that ``request`` takes.

    Returns:
        requests.Response: :class:`Response <Response>` object
    """

    kwargs.setdefault('allow_redirects', True)
    return request('get', url, params=params, **kwargs)


def options(url, **kwargs):
    """Sends an OPTIONS request.

    Args:
        url: URL for the new :class:`Request` object.
        **kwargs: Optional arguments that ``request`` takes.

    Returns:
        requests.Response: :class:`Response <Response>` object
    """

    kwargs.setdefault('allow_redirects', True)
    return request('options', url, **kwargs)


def head(url, **kwargs):
    """Sends a HEAD request.

    Args:
        url: URL for the new :class:`Request` object.
        **kwargs: Optional arguments that ``request`` takes.

    Returns:
        requests.Response: :class:`Response <Response>` object
    """

    kwargs.setdefault('allow_redirects', False)
    return request('head', url, **kwargs)


def post(url, data=None, json=None, **kwargs):
    """Sends a POST request.

    Args:
        url: URL for the new :class:`Request` object.
        data: (optional) Dictionary, list of tuples, bytes, or file-like object
            to send in the body of the :class:`Request`.
        json: (optional) json data to send in the body of the :class:`Request`.
        **kwargs: Optional arguments that ``request`` takes.

    Returns:
        requests.Response: :class:`Response <Response>` object
    """

    return request('post', url, data=data, json=json, **kwargs)


def put(url, data=None, **kwargs):
    """Sends a PUT request.

    Args:
        url: URL for the new :class:`Request` object.
        data: (optional) Dictionary, list of tuples, bytes, or file-like object
            to send in the body of the :class:`Request`.
        **kwargs: Optional arguments that ``request`` takes.

    Returns:
        requests.Response: :class:`Response <Response>` object
    """

    return request('put', url, data=data, **kwargs)


def patch(url, data=None, **kwargs):
    """Sends a PATCH request.

    Args:
        url: URL for the new :class:`Request` object.
        data: (optional) Dictionary, list of tuples, bytes, or file-like object
            to send in the body of the :class:`Request`.
        **kwargs: Optional arguments that ``request`` takes.

    Returns:
        requests.Response: :class:`Response <Response>` object
    """

    return request('patch', url, data=data, **kwargs)


def delete(url, **kwargs):
    """Sends a DELETE request.

    Args:
        url: URL for the new :class:`Request` object.
        **kwargs: Optional arguments that ``request`` takes.

    Returns:
        requests.Response: :class:`Response <Response>` object
    """

    return request('delete', url, **kwargs)
